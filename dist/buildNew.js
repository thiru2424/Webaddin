!function(){function e(){var e=document.getElementById("imageModal");e.style.display="block",document.querySelector(".close").addEventListener("click",(function(){e.style.display="none"})),window.addEventListener("click",(function(t){t.target===e&&(e.style.display="none")}))}function t(){var e=Array.from(document.querySelectorAll(".tab")),t=Array.from(document.querySelectorAll(".tab-content")),n=e.findIndex((function(e){return e.classList.contains("active")}));n>=0&&n<e.length-1&&(e[n].classList.remove("active"),t[n].classList.add("hidden"),e[n+1].classList.add("active"),t[n+1].classList.remove("hidden"),2===n?(document.getElementById("nextStepButton").classList.add("btn-disabled"),document.getElementById("buildWS").classList.remove("btn-disabled"),document.getElementById("buildWS").classList.add("btn-gray")):(document.getElementById("buildWS").classList.add("btn-disabled"),document.getElementById("nextStepButton").classList.remove("btn-disabled"),document.getElementById("nextStepButton").classList.add("btn-gray")))}function n(){var e=l("accountList"),t=document.getElementById("filterCurrency").value,n=document.getElementById("filterAccount").value.toLowerCase(),c=document.getElementById("filterAccountName").value.toLowerCase();E(e.filter((function(e){return(!t||"All"===t||e.currency===t)&&(!n||(e.accountNumber+"").includes(n))&&(!c||e.accountName.toLowerCase().includes(c))})),m())}function c(){document.getElementById("filterCurrency").value="All",document.getElementById("filterAccount").value="",document.getElementById("filterAccountName").value="",E(l("accountList"),m())}function d(e){var t=document.getElementById("reminders-table").querySelector("tbody");t.innerHTML="",e.forEach((function(e){var n=document.createElement("tr");n.innerHTML="\n          <td>".concat(e.accountNumber,"</td>\n          <td>").concat(e.threshold,"</td>\n          <td>").concat(e.action,"</td>\n          <td>").concat(e.template,"</td>\n          <td>").concat(e.from,"</td>\n          <td>").concat(e.to,"</td>\n      "),t.appendChild(n)}))}function o(){var e=document.getElementById("reminder-from"),t=document.getElementById("reminder-acc-dropdown"),n=document.getElementById("reminder-action"),c=document.getElementById("typeAmt");if(e.value){var o=l("remindersList"),a={accountNumber:t.value||"-",threshold:function(){var e=document.querySelector("input[name='ltgt-options']:checked");if(e){var t=document.querySelector('label[for="'.concat(e.id,'"]'));return t?t.textContent:"-"}return"-"}()+" "+c.value,action:n.value||"-",template:n.value||"-",from:e.value,to:t.value||"-"};o.push(a),localStorage.setItem("remindersList",JSON.stringify(o)),d(o)}}function a(){E(l("accountList"),m())}function l(e){return JSON.parse(localStorage.getItem(e))||[]}function r(e,t,n){var c=document.getElementById(e).querySelector("tbody"),d=document.getElementById(t).querySelector("tbody");c.addEventListener("click",(function(e){e.target.closest("tr")&&g(e,n)})),d.addEventListener("click",(function(e){e.target.closest("tr")&&g(e,n)})),document.getElementById("add-btn".concat(n?"":"-tx")).addEventListener("click",(function(){return u(c,d,n)})),document.getElementById("add-all-btn".concat(n?"":"-tx")).addEventListener("click",(function(){return i(c,d,n)})),document.getElementById("remove-btn".concat(n?"":"-tx")).addEventListener("click",(function(){return u(d,c,n)})),document.getElementById("remove-all-btn".concat(n?"":"-tx")).addEventListener("click",(function(){return i(d,c,n)}))}function u(e,t,n){Array.from(e.querySelectorAll(".selected")).forEach((function(e){e.classList.remove("selected"),t.appendChild(e)})),v(n)}function i(e,t,n){Array.from(e.children).forEach((function(e){e.classList.remove("selected"),t.appendChild(e)})),v(n)}function s(e,t,n){document.querySelectorAll("#".concat(e," thead th")).forEach((function(e,c){var o=!0;e.addEventListener("click",(function(){var e="account"===n&&0===c?m():"currency";t.sort((function(t,n){var c=isNaN(t[e])?String(t[e]||"").toLowerCase():Number(t[e]),d=isNaN(n[e])?String(n[e]||"").toLowerCase():Number(n[e]);return o?c>d?1:-1:c<d?1:-1})),o=!o,"account"===n?E(t,e):"transactions"===n?f(t):d(t)}))}))}function m(){return document.getElementById("view-account-name").checked?"accountName":"accountNumber"}function y(e,t,n,c,d){JSON.parse(localStorage.getItem(t)||"[]").forEach((function(t){var o=document.createElement("option");o.value=n?t[n]:t,o.textContent=d&&n&&c?t[n]+" "+t[c]:c?t[c]:t,e.appendChild(o)}))}function E(e,t){var n=document.getElementById("available-accounts").querySelector("tbody");n.innerHTML="",e.forEach((function(e){var c=document.createElement("tr");c.innerHTML="<td>".concat("accountName"===t?e.accountName:e.accountNumber,"</td><td>").concat(e.currency,"</td>"),n.appendChild(c)}))}function f(e){var t=document.getElementById("available-tx").querySelector("tbody");t.innerHTML="",e.forEach((function(e){var n=document.createElement("tr");n.innerHTML="<td>".concat(e.description,"</td>"),t.appendChild(n)}))}function v(e){var t=document.getElementById(e?"available-accounts":"available-tx").querySelector("tbody"),n=document.getElementById(e?"selected-accounts":"selected-tx").querySelector("tbody");document.getElementById(e?"accounts-total":"total-tx").textContent="".concat(t.children.length," items"),document.getElementById(e?"accounts-selected":"selected-avb-tx").textContent="".concat(t.querySelectorAll(".selected").length," Selected"),document.getElementById(e?"accounts-total-sel":"total-sel-tx").textContent="".concat(n.children.length," items"),document.getElementById(e?"accounts-selected-sel":"selected-sel-tx").textContent="".concat(n.querySelectorAll(".selected").length," Selected")}function g(e,t){var n=e.target.closest("tr");n&&(e.ctrlKey||e.metaKey?n.classList.toggle("selected"):(n.closest("tbody").querySelectorAll(".selected").forEach((function(e){return e.classList.remove("selected")})),n.classList.add("selected")),v(t))}Office.onReady((function(){document.getElementById("balanceExample").addEventListener("click",e),document.getElementById("nextStepButton").addEventListener("click",t),document.getElementById("applyFilter").addEventListener("click",n),document.getElementById("removeFilter").addEventListener("click",c),document.getElementById("reminder-from").addEventListener("change",o),r("available-accounts","selected-accounts",!0),r("available-tx","selected-tx",!1),document.querySelectorAll(".tab").forEach((function(e){e.addEventListener("click",(function(){document.querySelectorAll(".tab").forEach((function(e){return e.classList.remove("active")})),e.classList.add("active"),document.querySelectorAll(".tab-content").forEach((function(e){return e.classList.add("hidden")})),document.getElementById(e.getAttribute("data-tab")).classList.remove("hidden"),"reminders"===e.getAttribute("data-tab")?(document.getElementById("nextStepButton").classList.add("btn-disabled"),document.getElementById("buildWS").classList.remove("btn-disabled"),document.getElementById("buildWS").classList.add("btn-gray")):(document.getElementById("buildWS").classList.add("btn-disabled"),document.getElementById("nextStepButton").classList.remove("btn-disabled"),document.getElementById("nextStepButton").classList.add("btn-gray"))}))})),document.getElementById("view-account-number").addEventListener("change",(function(){return a()})),document.getElementById("view-account-name").addEventListener("change",(function(){return a()})),function(){y(document.getElementById("filterCurrency"),"currencyList"),y(document.getElementById("base-currency-dropdown"),"currencyList"),y(document.getElementById("reminder-acc-dropdown"),"accountList","accountNumber","accountName",!0),y(document.getElementById("reminder-from"),"accountList","accountNumber","accountName",!0),y(document.getElementById("reminder-action"),"paymentMethodList","code","description",!1);var e=l("accountList"),t=l("transactionList"),n=l("remindersList");E(e,"accountNumber"),f(t),v(!0),v(!1),s("available-accounts",e,"account"),s("available-tx",t,"transactions"),s("reminders-table",n,"reminders")}()}))}();
//# sourceMappingURL=buildNew.js.map